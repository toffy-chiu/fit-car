webpackJsonp([2],{15:function(e,t,n){e.exports={dateFormat:function(e,t){function n(e){return e<10&&(e="0"+e),e}var a=e,r=a.getFullYear(),o=n(a.getMonth()+1),i=n(a.getDate()),s=n(a.getHours()),c=n(a.getMinutes()),l=n(a.getSeconds());return t.replace("yyyy",r).replace("MM",o).replace("dd",i).replace("HH",s).replace("mm",c).replace("ss",l)},objectAssign:function(e,t){for(var n in t)e[n]=t[n];return e}}},21:function(e,t,n){function a(){this.TABLE_CONSUMPTION="consumption"}var r=n(15),o=9,i="fit-car";a.prototype.index_date=["date"],a.prototype.keyRange={atMonth:function(e){return IDBKeyRange.bound([e[0]+"-01"],[e[0]+"-31"])}},a.prototype.open=function(e){var t=this,n=window.indexedDB.open(i,o);n.onerror=function(e){console.log(e.currentTarget.error.message)},n.onsuccess=function(t){var n=t.target.result;e(n)},n.onupgradeneeded=function(e){var n,a=e.target.result;if(a.objectStoreNames.contains(t.TABLE_CONSUMPTION)){var r=e.target.transaction;n=r.objectStore(t.TABLE_CONSUMPTION);for(var i=n.indexNames,s=0;s<i.length;s++)n.deleteIndex(i[s])}else n=a.createObjectStore(t.TABLE_CONSUMPTION,{autoIncrement:!0});n.createIndex("index_date",t.index_date,{unique:!1}),console.log("DB version changed to "+o)}},a.prototype.add=function(e,t){this.open(function(n){var a=n.transaction(e,"readwrite"),r=a.objectStore(e);"[object Array]"===Object.prototype.toString.apply(t)?t.forEach(function(e){r.add(e)}):r.add(t),n.close()})},a.prototype.save=function(e,t,n){this.open(function(a){var o=a.transaction(e,"readwrite"),i=o.objectStore(e),s=i.get(+t);s.onsuccess=function(e){var a=e.target.result;r.objectAssign(a,n),i.put(a,+t)}})},a.prototype.del=function(e,t){this.open(function(n){var a=n.transaction(e,"readwrite"),r=a.objectStore(e);t?r["delete"](+t):r.clear()})},a.prototype.get=function(e,t,n){this.open(function(a){var r=a.transaction(e,"readonly"),o=r.objectStore(e),i=o.get(+t);i.onsuccess=function(e){var t=e.target.result;n(t)}})},a.prototype.getList=function(e,t,n,a){this.open(function(r){var o,i=r.transaction(e,"readonly"),s=i.objectStore(e);if(n&&a){var c=s.index("index_"+n.join("_"));o=c.openCursor(a)}else o=s.openCursor();var l=[];o.onsuccess=function(e){var n=e.target.result;if(n){var a=n.value;a.id=n.primaryKey,l.push(a),n["continue"]()}else t(l),r.close()}})},e.exports=new a},28:function(e,t,n){e.exports={gas:{name:"加油",icon:"info",color:"#B0D865"},park:{name:"停车",icon:"info",color:"#4384EB"},wash:{name:"洗车",icon:"info",color:"#3DB9EF"},maintain:{name:"保养",icon:"info",color:"#4DC23D"},fix:{name:"维修",icon:"info",color:"#F7731B"},breach:{name:"违章",icon:"info",color:"#FF6565"},road:{name:"过路",icon:"info",color:"#22BB9F"},others:{name:"其他",icon:"info",color:"#868BE8"}}},178:function(e,t,n){var a=n(1),r=n(20),o=r.NavBar,i=r.TabBar,s=r.Container,c=n(183),l=n(180),u=n(21);e.exports=a.createClass({displayName:"module.exports",getInitialState:function(){return{date:"",tableValue:{}}},topDateChange:function(e){this.setState({date:e}),u.getList(u.TABLE_CONSUMPTION,function(e){var t={gas:0,park:0,wash:0,maintain:0,fix:0,breach:0,road:0,others:0};e.forEach(function(e){t[e.type]+=+e.amount}),this.setState({tableValue:t})}.bind(this),u.index_date,u.keyRange.atMonth([e]))},render:function(){var e={title:"车消费记录",amStyle:"primary"};return a.createElement(s,{fill:!0,direction:"column"},a.createElement("div",{className:"views"},a.createElement(o,a.__spread({},e)),a.createElement(c,{onDateChange:this.topDateChange}),a.createElement(l,{value:this.state.tableValue})),a.createElement(i,{amStyle:"primary",className:"padding-h-0"},a.createElement(i.Item,{title:"记一笔",icon:"plus",href:"#/edit"}),a.createElement(i.Item,{title:"当月明细",icon:"list",href:"#/detail/"+this.state.date}),a.createElement(i.Item,{title:"花销总览",icon:"pages",href:"#/overview"}),a.createElement(i.Item,{title:"设置",icon:"gear",href:"#/setting"})))}})},180:function(e,t,n){var a=n(1),r=n(20),o=r.Grid,i=r.Col,s=r.Icon,c=r.Group,l=n(28);e.exports=a.createClass({displayName:"module.exports",getItemHTML:function(e){return a.createElement(i,null,a.createElement(s,{name:l[e].icon,style:{"float":"left",marginTop:-2,fontSize:28,color:this.props.value[e]?l[e].color:"#ccc"}}),a.createElement("span",{style:{marginLeft:"3px"}},l[e].name),this.props.value[e]?a.createElement("span",{className:"fr"},"￥",this.props.value[e]):null)},render:function(){return a.createElement(c,{noPadded:!0,className:"margin-0"},a.createElement(o,{bordered:!0,avg:2,className:"itemTable"},this.getItemHTML("gas"),this.getItemHTML("park"),this.getItemHTML("wash"),this.getItemHTML("maintain"),this.getItemHTML("fix"),this.getItemHTML("breach"),this.getItemHTML("road"),this.getItemHTML("others")))}})},183:function(e,t,n){var a=n(1),r=n(20),o=r.Icon;e.exports=a.createClass({displayName:"module.exports",getInitialState:function(){var e=new Date;return{year:e.getFullYear(),month:e.getMonth()}},triggerUpdate:function(){this.props.onDateChange(this.state.year+"-"+(this.state.month<9?"0":"")+(this.state.month+1))},componentDidMount:function(){this.triggerUpdate()},handleClick:function(e){e.preventDefault();var t=e.currentTarget.getAttribute("data-ctrl");"prev"==t?this.state.month<1?(this.state.year-=1,this.state.month=11):this.state.month-=1:"next"==t&&(this.state.month>10?(this.state.year+=1,this.state.month=0):this.state.month+=1),this.setState(this.state),this.triggerUpdate()},render:function(){return a.createElement("div",{className:"topDate"},a.createElement(o,{name:"left-nav","data-ctrl":"prev",onClick:this.handleClick,onTouchStart:this.handleClick}),a.createElement("span",null," ",this.state.year,"年",(this.state.month<9?"0":"")+(this.state.month+1),"月 "),a.createElement(o,{name:"right-nav","data-ctrl":"next",onClick:this.handleClick,onTouchStart:this.handleClick}))}})}});